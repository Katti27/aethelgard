/* ============================================================
   Flowershow Cloud — Obsidian ITS-inspired (DARK ONLY) — v7
   Fixes requested:
   1) Links still appear grey -> force ALL content anchors to blue (!important)
   2) Black title box behind H1 -> remove background on common H1 wrapper blocks
      (uses :has() where supported + safe fallbacks)

   Rule reminder: BLUE = links only.
   ============================================================ */

/* Fonts */
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Fira+Code:wght@400;500;600&family=Cinzel:wght@500;600;700&family=Cinzel+Decorative:wght@700&display=swap");

:root,
html,
body,
html[data-theme],
body[data-theme]{
  color-scheme: dark;

  --topbar: #0b0f13;
  --sidebar: #0b0f13;
  --canvas: #1a1e24;
  --panel: #11151d;

  --text: #cfd7dd;
  --muted: #97a1b9;

  --red: #c14343;
  --red-line: rgba(193, 67, 67, 0.70);

  --orange: #e79c5d;
  --orange-line: rgba(231, 156, 93, 0.75);

  --blue: #61afef;

  --rule: #2f3b4d;

  --font: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
  --mono: "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --display: "Cinzel Decorative", "Cinzel", Georgia, serif;
  --display-2: "Cinzel", Georgia, serif;

  --focus: color-mix(in oklab, var(--blue) 45%, transparent);
  --active-bg: rgba(193, 67, 67, 0.18);
}

/* Base */
html, body{
  background: var(--canvas) !important;
  color: var(--text);
  font-family: var(--font);
}

::selection{ background: rgba(122, 20, 20, 0.40); }

:where(a, button, summary, input, textarea, select):focus-visible{
  outline: 3px solid var(--focus);
  outline-offset: 3px;
  border-radius: 10px;
}

/* Chrome */
:where(header, nav, .site-navbar, body > header, body > nav){
  background: var(--topbar) !important;
  border-bottom: 1px solid var(--rule);
}
:where(aside, .site-sidebar){
  background: var(--sidebar) !important;
  border-right: 1px solid var(--rule);
}

/* Sidebar/TOC links */
:where(nav, aside) a{
  color: color-mix(in oklab, var(--muted) 85%, var(--blue)) !important;
  text-decoration: none;
}
:where(nav, aside) a:hover{
  color: var(--blue) !important;
  text-decoration: underline;
  text-underline-offset: 3px;
}
:where(nav, aside) a[aria-current="page"],
:where(nav, aside) a[aria-current="true"]{
  color: var(--text) !important;
  font-weight: 700;
  background: var(--active-bg);
  border-left: 3px solid var(--red);
  padding-left: 0.55rem;
  border-radius: 6px;
}

/* Inputs */
:where(header, nav, aside) :where(input, textarea){
  background: rgba(0,0,0,0.35);
  color: var(--text);
  border: 1px solid color-mix(in oklab, var(--rule) 70%, transparent);
  border-radius: 8px;
}

/* Flat editor content */
:where(main) :where(article, .prose, .markdown, .content){
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  padding: 1.5rem 1.75rem;
  max-width: 980px;
}

/* Prose tokens */
.prose{
  font-family: var(--font);
  line-height: 1.62;
  font-size: 1rem;

  --tw-prose-body: var(--text);
  --tw-prose-headings: var(--text);
  --tw-prose-links: var(--blue);
  --tw-prose-bullets: var(--muted);
  --tw-prose-counters: var(--muted);
  --tw-prose-hr: var(--rule);
  --tw-prose-quotes: var(--text);
  --tw-prose-quote-borders: var(--rule);
  --tw-prose-captions: var(--muted);
  --tw-prose-code: #fa4545;
  --tw-prose-pre-bg: #232831;
  --tw-prose-th-borders: var(--rule);
  --tw-prose-td-borders: var(--rule);
}

/* ============================================================
   FIX 1: FORCE LINKS BLUE (content area)
   Some Flowershow pages apply Tailwind utility colors directly
   onto <a> tags, which can override weaker selectors.
   We intentionally use !important to win.
   ============================================================ */
:where(main, article, .prose) a,
:where(main, article, .prose) a:visited,
:where(main, article, .prose) a:active{
  color: var(--blue) !important;
}

/* Obsidian-ish: no underline by default, underline on hover */
:where(main, article, .prose) a{
  text-decoration: none !important;
  border-bottom: 1px solid rgba(97,175,239,0.35);
  padding-bottom: 1px;
}
:where(main, article, .prose) a:hover{
  border-bottom-color: rgba(97,175,239,0.85);
}

/* Make sure link-like lists (your “Era Outline” entries) inherit the same */
:where(main, article, .prose) li a{
  color: var(--blue) !important;
}

/* ============================================================
   FIX 2: REMOVE BLACK TITLE BOX (H1 wrapper)
   Flowershow sometimes wraps the title in a div/header with a
   background class. We strip it if it contains an H1.
   ============================================================ */

/* If browser supports :has() */
:where(main) :where(div, header, section):has(> h1){
  background: transparent !important;
  box-shadow: none !important;
  border: 0 !important;
  border-radius: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* Extra: any element with bg-* class that contains h1 */
:where(main) :where([class*="bg-"]):has(h1){
  background: transparent !important;
}

/* Fallback (no :has): the first block inside the article is almost always the title wrapper */
:where(main) :where(article, .prose, .markdown, .content) > :first-child{
  background: transparent !important;
  box-shadow: none !important;
  border: 0 !important;
}

/* -----------------------------
   Headings (no blue headings)
------------------------------ */

/* H1 */
:where(main, article) h1{
  background: transparent !important;
  box-shadow: none !important;
  border: 0 !important;

  color: var(--red) !important;
  font-family: var(--display) !important;
  font-weight: 700 !important;
  letter-spacing: 0.03em;
  text-align: left !important;

  font-size: clamp(1.8rem, 2.4vw, 2.25rem) !important;
  margin: 0.2rem 0 1rem !important;
  padding: 0 !important;
}
:where(main, article) h1::after{
  content: "";
  display: block;
  margin-top: 0.35rem;
  height: 2px;
  width: 100%;
  background: linear-gradient(to right, var(--red-line), rgba(193,67,67,0.10));
}

/* H2 */
:where(main, article, .prose) h2{
  color: var(--red) !important;
  font-family: var(--display-2) !important;
  font-weight: 700 !important;
  letter-spacing: 0.02em;
  margin-top: 1.55rem !important;
  margin-bottom: 0.55rem !important;
  position: relative;
  padding-bottom: 0.25rem !important;
  font-variant: small-caps;
}
:where(main, article, .prose) h2::after{
  content: "";
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 100%;
  height: 2px;
  background: linear-gradient(to right, var(--red-line), rgba(193,67,67,0.12));
}

/* H3 */
:where(main, article, .prose) h3{
  color: var(--orange) !important;
  font-family: var(--display-2) !important;
  font-weight: 700 !important;
  letter-spacing: 0.01em;
  margin-top: 1.15rem !important;
  margin-bottom: 0.45rem !important;
  position: relative;
  padding-bottom: 0.15rem !important;
}
:where(main, article, .prose) h3::after{
  content: "";
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 60%;
  height: 2px;
  background: linear-gradient(to right, var(--orange-line), transparent);
}

/* H4+ muted */
:where(main, article, .prose) :where(h4,h5,h6){
  color: color-mix(in oklab, var(--text) 80%, var(--muted)) !important;
  font-family: var(--font) !important;
  font-weight: 700;
}

/* Italics in headings */
:where(main, article, .prose) :where(h1,h2,h3,h4) em{
  color: var(--orange) !important;
  font-style: italic;
  font-weight: 600;
}

/* HR */
.prose hr{
  border: none;
  height: 2px;
  background: linear-gradient(to right, transparent, var(--red-line), transparent);
  margin: 1.8rem 0;
}

/* Lists: markers */
.prose ul > li::marker,
.prose ol > li::marker{
  color: color-mix(in oklab, var(--muted) 80%, var(--red));
}

/* Code */
.prose :not(pre) > code{
  font-family: var(--mono);
  background: color-mix(in oklab, #232831 70%, transparent);
  border: 1px solid color-mix(in oklab, var(--rule) 70%, transparent);
  border-radius: 8px;
  padding: 0.12em 0.35em;
}
.prose pre{
  background: #232831 !important;
  border: 1px solid color-mix(in oklab, var(--rule) 75%, transparent);
  border-radius: 12px;
}

/* Blockquotes */
.prose blockquote{
  background: var(--panel);
  border-left: 4px solid var(--red-line);
  border-radius: 10px;
  padding: 0.85rem 1rem;
}

/* Scrollbar */
*::-webkit-scrollbar{ width: 10px; height: 10px; }
*::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.14);
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: content-box;
}
*::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,0.22); }

/* Mobile */
@media (max-width: 640px){
  :where(main) :where(article, .prose, .markdown, .content){
    padding: 1.1rem 1rem;
  }
}
